machine:
  node:
    version: 0.10.33
  python:
    version: 2.7.3
  services:
   - redis

checkout:
  post:
    - echo "_auth = `printf $NPM_AUTH`" >> ~/.npmrc

dependencies:
  pre:
    - pip install awscli
  override:
    - npm install --registry https://segmentio.registry.nodejitsu.com --no-strict-ssl --always-auth

test:
  post:
    - if [ -n "$FORCE" ]; then curl -l -s $BOOSH | sh > /dev/null; fi

deployment:
  s3:
   branch: master
   owner: segmentio
   commands:
    - curl -l -s $BOOSH | sh > /dev/null